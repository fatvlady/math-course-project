% !TeX root=../main.tex
\section{Дослідження моделі з вибором місця для авто за сумішшю рівномірного та розподілу Бернулі}
\label{sec:model}
%TODO:

В цій моделі водії вибирають місце для автомобіля, керуючись наступним правилом
\begin{itemize}
	\item з ймовірністю $p$ водій ставить автомобіль в правому кінці вільного проміжку, 
	\item з ймовірністю $q = 1 - p$ водій вибирає місце керуючись рівномірним розподілом.
\end{itemize}

\subsection{Виведення інтегрального рівняння}

Нескладно переконатись, що порядок вибору вільних проміжків водіями не впливає на результат, тому будемо вважати, що після паркування одного автомобіля парковка розбивається на 2 частини, і після цього спочатку заповнюється ліва частина, а потім права.

Необхідно визначити $m_{p}(x)=\EE F(x)$. Нехай $\xi \sim Uniform(0, x - 1)$ – випадкова величина, що визначає положення лівого краю першого автомобіля на парковці у випадку вибору місця за рівномірним розподілом. Тоді маємо наступну тотожність:
\[
\begin{split}
m_{p} (x) = p(1+ m_{p} (x-1)) + q(1+ \EE(\EE(F(\xi) + F(x - 1 - \xi)  | \xi))) =\\
=1 + p m_{p} (x-1) + q \int\limits_0^{x-1} m_{p} (t) \frac{1}{x − 1} dt + q \int\limits_0^{x-1} m_{p} (x − t − 1) \frac{1}{x − 1} dt 
\end{split}
\]

Так як
$$\int\limits_0^{x-1} m_{p} (x − t − 1) dt = \< u=x - t - 1 \> = - \int\limits_{x-1}^0 m_{p} (u) du = \int\limits_0^{x-1}  m_{p} (u) du,$$

то
\begin{equation}
m_{p} (x) = 1 + p m_{p} (x - 1) + \frac{2q}{x - 1} \int\limits_0^{x - 1} m_{p} (t) d
\end{equation}

Для зручності зробимо заміну $x \rightarrow x + 1$. Отримаємо

\begin{equation}
\label{eq:model_equation}
m_{p} (x + 1) = 1 + p m_{p} (x) + \frac{2q}{x} \int\limits_0^{x} m_{p} (t) dt,\quad \forall x > 0
\end{equation}

Таким чином, отримали інтегральне рівняння. До того ж, відомо, що
\begin{equation}
\label{eq:zero_state}
m_{p}(x) \equiv 0, \quad x \in [0; 1)
\end{equation}

Спираючись на \eqref{eq:upperbound} та \eqref{eq:lowerbound}, маємо обмеження на $m(x)$:
\begin{equation}
\label{eq:bounds}
\left[\frac{x+1}{2}\right] \leq m_{p}(x) \leq \left[x\right]
\end{equation}

З цієї нерівності випливає, що якщо є якась асимптотика у функції $m_{p}(x)$, то вона порядку $x$, тобто
\begin{equation}
\label{eq:bounds_inference}
m_{p}(x) \sim C_{p}\cdot x \text{ при } x \rightarrow +\infty, \quad C_{p} \in [0.5; 1]
\end{equation}

\subsection{Перехід до зображення Лапласа}
\label{sec:model_integral_laplace}

Спробуємо розв'язати \eqref{eq:model_equation} за допомогою перетворення Лапласа.

Оскільки виконується \eqref{eq:bounds}, то зображення Лапласа для $m_{p}(x)$ існує. До того ж, за властивістю \eqref{eq:laplace_lag}:
\begin{equation}
\label{eq:model_shifted_laplace}
\Lapl{m_{p}(x+1)}=\<\eqref{eq:zero_state}\>=\Lapl{m_{p}(x+1)\eta(x+1)}=e^s M_{p} (s).
\end{equation}

Оскільки $m_{p}(x) \leq x$, то $\int\limits_0^x m_{p}(t) dt < x^2$, тобто для інтегралу від $m_{p}(x)$ зображення також існує, за властивістю \eqref{eq:laplace_int_origin}:
$$\Lapl{\int\limits_0^x m_p(t) dt} = \frac{M_p(s)}{s}.$$

Аналогічно доводиться, що $\frac{1}{x}\int\limits_0^x m_{p}(t) dt < x$ при $x>0$, а тому зображення Лапласа для цього виразу також існує. Тоді за властивістю \eqref{eq:laplace_int_image}:
$$\Lapl{\frac{2}{x}\int\limits_0^x m_{p}(t) dt} = 2 \int\limits_s^\infty \frac{M_{p}(u)}{u} du.$$

Таким чином, отримали інтегральне рівняння в термінах зображення Лапласа, яке вже можна розв'язати, адже нема зсуву:
\begin{equation}
\label{eq:model_laplace_integral}
e^s M_{p}(s) = p M_{p}(s) + 2q \int\limits_s^\infty \frac{M_{p}(u)}{u} du + \frac{1}{s}
\end{equation}

Продиференціюємо обидві частини рівняння відносно $s$:
\begin{equation}
e^s M_{p}(s) + e^s \dot M_{p}(s) =p \dot M_{p}(s) - 2 q \frac{M_{p}(s)}{s}  - \frac1{s^2}
\end{equation}

Виразимо $\dot M_{p}(s)$ з цього рівняння:
\begin{equation}
\label{eq:model_laplace_diff}
\dot M_{p}(s) = - M_{p}(s)\left(\frac{e^s}{e^s - p} + \frac{2q}{s(e^s - p)}\right) - \frac{1}{s^2(e^s - p)}
\end{equation}

Розв'яжемо отримане диференційне рівняння. Спочатку розв'яжемо однорідну частину:
\begin{align*}
\dot M_{p}^{h} (s) &= - M_{p}^{h} (s)\left(\frac{e^s}{e^s - p} + \frac{2q}{s(e^s - p)}\right) \\
\frac{\dot M_{p}^{h} (s)}{M_{p}^{h} (s)} &= -\left(\frac{e^s}{e^s - p} + \frac{2q}{s(e^s - p)}\right) \\
\int\limits_1^s \frac{\dot M_{p}^{h} (u)}{M_{p}^{h} (u)} du &= -\int\limits_1^s \left(\frac{e^u}{e^u - p} + \frac{2q}{u(e^u - p)}\right) du \\
\left. \ln{M_{p}^{h} (u)}\right|_1^s &= - \int\limits_1^s \frac{e^u}{e^u - p} du  - 2 \int\limits_1^s \frac{q}{u(e^u - p)} du
\end{align*}

Позначимо
\begin{equation}
\label{eq:partial_li_p}
Q_p(s) := \int\limits_1^s \frac{q}{u(e^u - p)} du
\end{equation}

Оскільки
\begin{align*}
\int\limits_1^s \frac{e^u}{e^u - p} du &= \< u = e^u - p,~ du = e^u du = (u+p) du \> = \\
&= \int\limits_{e-p}^{e^s -p} \frac{u + p}{u} (u+p)^{-1} du = 
\int\limits_{e-p}^{e^s -p} \frac{du}{u} = \\
&= \log(e^s - p) - \log(e-p) = \log \frac{e^s - p}{e - p} \text{,}
\end{align*}

то
\begin{align*}
\ln{M_{p}^{h} (s)} &= \ln{M_{p}^{h} (1)} - \log \frac{e^s - p}{e - p} - 2Q_p(s) \\
M_{p}^{h} (s) &= M_{p}^{h} (1) \cdot \frac{e - p}{e^s - p} \cdot e^{- 2Q_p(s)} \cdot const
\end{align*}

Оскільки $M(1)$ та $(e-p)$ можна включити в константу, то маємо розв'язок
\begin{equation}
\label{eq:model_laplace_homogen_sol}
M_{p}^{h} (s) = C \cdot \left((e^s - p)  e^{2Q_p(s)}\right)^{-1}, \quad \forall C \in \RR
\end{equation}

Дійсно, перевіримо цей розв'язок:
\[
\begin{split}
\dot M_{p}^{h} (s) &= C \cdot \frac{\partial}{\partial s} \left(\frac{1}{(e^s - p)  e^{2Q_p(s)}}\right)=\\
&= - C \cdot \left(\frac{1}{(e^s - p)  e^{2Q_p(s)}}\right)^2 \cdot \left(e^s  + (e^s - p) \frac{2q}{s(e^s - p)}   \right) e^{2Q_p(s)} =\\
&= -C \left((e^s - p)  e^{2Q_p(s)}\right)^{-1} \cdot \left(\frac{e^s}{e^s - p}  + \frac{2q}{s(e^s - p)}   \right) =\\
&= - M_{p}^{h}(s) \cdot \left(\frac{e^s}{e^s - p}  + \frac{2q}{s(e^s - p)}   \right)
\end{split}
\]

Нескладно помітити, що отримали вихідне рівняння. Тепер застосуємо метод варіації довільних сталих:
$$
M_{p}(s) = C(s) \cdot \left((e^s - p)  e^{2Q_p(s)}\right)^{-1} 
$$

Продиференціювавши відносно $s$, отримаємо:
\begin{align*}
\dot M_{p}(s) &= \dot C(s) \cdot \left((e^s - p)  e^{2Q_p(s)}\right)^{-1} -C(s) \left((e^s - p)  e^{2Q_p(s)}\right)^{-1} \cdot \\
&\cdot \left(\frac{e^s}{e^s - p}  + \frac{2q}{s(e^s - p)}   \right) 
\end{align*}

З іншої сторони, з \eqref{eq:model_laplace_diff} маємо
$$
\dot M_{p}(s) = - C(s) \left((e^s - p)  e^{2Q_p(s)}\right)^{-1}  \left(\frac{e^s}{e^s - p} + \frac{2q}{s(e^s - p)}\right) - \frac{1}{s^2(e^s - p)} \quad	
$$
Тому
$$
\dot C(s) = - \left((e^s - p)  e^{2Q_p(s)}\right) \cdot  \frac{1}{s^2(e^s - p)} =  - \frac{e^{2Q_p(s)}}{s^2}
$$

Тоді простим інтегруванням в межах від 1 до $s$ отримуємо:
\begin{equation}
C(s) = -  \int\limits_1^s \frac{e^{2Q_p(u)}}{u^2} du + const
\end{equation}

І тоді отримуємо вираз для $M_{p}(s)$:
\begin{equation}
\begin{split}
M_{p}(s)=- \left( \int\limits_1^s \frac{e^{2Q_p(u)}}{u^2} du + const \right) \left((e^s - p)  e^{2Q_p(s)}\right)^{-1}  =\\
= - \left( \int\limits_1^s \frac{e^{2Q_p(u)}}{u^2} du + K \right) \frac{1}{(e^s - p)  e^{2Q_p(s)}}, \quad K \in \RR
\end{split}
\end{equation}

Перевіримо отриманий результат:
\begin{equation*}
\begin{split}
&\dot M_{p}(s) = - \frac{\partial}{\partial s}\left( \int\limits_1^s \frac{e^{2Q_p(u)}}{u^2} du + K \right) \frac{1}{(e^s - p)  e^{2Q_p(s)}} -\left( \int\limits_1^s \frac{e^{2Q_p(u)}}{u^2} du + K \right)\cdot \\ 
&\cdot \left(\frac{1}{(e^s - p)  e^{2Q_p(s)}}\right)' = -\frac{e^{2Q_p(s)}}{s^2} \frac{1}{(e^s - p)  e^{2Q_p(s)}}  + \left( \int\limits_1^s \frac{e^{2Q_p(u)}}{u^2} du + K \right) \cdot \\
& \cdot \left((e^s - p)  e^{2Q_p(s)}\right)^{-1} \cdot \left(\frac{e^s}{e^s - p}  + \frac{2q}{s(e^s - p)}   \right)= -\frac{1}{s^2(e^s - p)} -\\
&- M_{p}(s)\left(\frac{e^s}{e^s - p}  + \frac{2q}{s(e^s - p)}   \right)
\end{split}
\end{equation*}

Перевірено. Тоді остаточний результат без вирахування константи:
\begin{equation}
\label{eq:model_laplace_sol_initial}
M_p(s)= \left( \int\limits_s^1 \frac{e^{2Q_p(u)}}{u^2} du + K \right) \frac{1}{(e^s - p)  e^{2Q_p(s)}}
\end{equation}

Спираючись на \eqref{eq:model_shifted_laplace}, маємо
\begin{equation}
\Lapl{m_p(x+1)} =\tilde M_p(s)= \left( \int\limits_s^1 \frac{e^{2Q_p(u)}}{u^2} du + K \right) \frac{e^s}{e^s - p} e^{- 2Q_p(s)}.
\end{equation}

За властивістю перетворення Лапласа $\tilde M_p(s) \rightarrow 0,\; s \rightarrow +\infty$. \todo{Можна навести твердження про границю у правосторонньому секторі, обмеженому двома похилими прямими з обмеженим кутом нахилу.}

Розглянемо $Q_p(s)$ ($s$ розглядаємо на дійсній вісі):
\begin{equation}
\begin{split}
\label{eq:q_p_s_major}
&Q_p(s) = \int\limits_1^s \frac{1-p}{u(e^u - p)} du <  \int\limits_1^\infty \frac{1 - p}{u(e^u - p)} du < 
\int\limits_1^\infty \frac{1- p}{e^u - p} du<\\
&< \int\limits_1^\infty \frac{1}{e^u} du = \exp(-1) - \exp(-\infty) = \exp(-1)
\end{split}
\end{equation}

Останній перехід нерівності пояснюється досить просто:
$$
\frac{1-p}{u - p} < \frac{1}{p}, \; u > 1 \Leftrightarrow u - u p = u(1-p) < u - p, \; u > 1
$$

Тобто $Q_p(s)$ - обмежена на $[1; \infty]$. Тому обмеженими на цій вісі будуть і $e^{\pm 2Q_p(s)}$. Також зрозуміло, що якщо інтегрувати по дійсній вісі, то $Q_p(s)$ – монотонно зростаюча за $s$. Тому
\begin{equation}
0 = \tilde M_p(\infty) = \lim_{s\rightarrow \infty} \tilde M_p(s) = \left( \int\limits_\infty^1 \frac{e^{2Q_p(u)}}{u^2} du + K \right) \lim_{s\rightarrow \infty} e^{- 2Q_p(s)}
\end{equation}

Тут $\lim\limits_{s\rightarrow \infty} e^{- 2Q_p(s)} = const > 0$, тому маємо, що
\begin{equation}
K = -  \int\limits_\infty^1 \frac{e^{2Q_p(u)}}{u^2} du =  \int\limits_1^\infty \frac{e^{2Q_p(u)}}{u^2} du.
\end{equation}

Таким чином, отримали нову версію $M_{p}(s)$:
\begin{equation}
\begin{split}
\label{eq:model_laplace_sol}
M_p(s)&= \left( \int\limits_s^1 \frac{e^{2Q_p(u)}}{u^2} du + K \right) \frac{1}{(e^s - p)  e^{2Q_p(s)}}
= \\
&=\frac{1}{(e^s - p)  e^{2Q_p(s)}} \int\limits_s^\infty \frac{e^{2Q_p(u)}}{u^2} du
\end{split}
\end{equation}

\subsection{Застосування тауберівської теореми}

Для знаходження асимптотики $m_p(x)$ на нескінченності, за теоремою Таубера \eqref{eq:tauber_thm} необхідно визначити асимптотику $M_p(s)$ при $s \rightarrow 0$.

Якщо знайти такі $C \in \RR$ та $\delta \in \RR^+$, що $M_p(s) \sim C \cdot s^{-\delta}, \; s \rightarrow 0$, то можна стверджувати, що $\int\limits_0^x m_p(x) dx \sim \frac{1}{\Gamma(\delta + 1)} C x^\delta, \; x \rightarrow \infty$. Вже зараз зрозуміло, що $\delta = 2$, адже теорема справедлива в обидва боки і виконується \eqref{eq:bounds_inference}.

Для цього розглянему поведінку в нулі трьох множників, з яких складається $M_p(s)$, а саме:
\begin{enumerate}
	\item $\displaystyle\frac{1}{e^s - p}$;
	\item $e^{-2Q_p(s)}$;
	\item $\displaystyle\int\limits_s^\infty \frac{e^{2Q_p(u)}}{u^2} du$.
\end{enumerate}

Щодо першого множнику, то в 0 він, очевидно, прямує до $\frac{1}{1-p}$.

Для наступного аналізу доведемо деякі леми.

\begin{lem}
	\label{eq:exp_q_p_s_asymptotics}
	$e^{-2Q_{p}(s)}$ поводиться як $s^{-2}$ в 0, з точністю до константи, а саме:
	\begin{equation}
	\lim\limits_{s \rightarrow 0} \frac{e^{-2Q_{p}(s)}}{s^{-2}} = \exp\left(-2\int\limits_0^1 \frac{e^u  - 1}{u(e^u - p)} du\right)
	\end{equation}
\end{lem}
\begin{proof}
	Для знаходження границі прологарифмуємо вираз. Отримаємо:
	\[
	\begin{split}
	2 \ln s - 2 Q_p(s) = 2 \ln s &- 2 \int\limits_1^s \frac{1 - p}{u(e^u - p)} du = 2 \int\limits_1^s \frac{1}{u} du - \\
	- 2 \int\limits_1^s \frac{1 - p}{u(e^u - p)} du &= 2  \int\limits_1^s \frac{e^u - 1}{u(e^u - p)} du = -2 \int\limits_s^1 \frac{e^u - 1}{u(e^u - p)} du
	\end{split}
	\]
	Тепер, підвівши до експоненти обидві частини, отримаємо:
	$$
	\frac{e^{-2Q_p(s)}}{s^{-2}} = \exp\left(-2 \int\limits_s^1 \frac{e^u - 1}{u(e^u - p)} du\right)
	$$
	Якщо довести, що інтеграл
	$$
	-2 \int\limits_0^1 \frac{e^u - 1}{u(e^u - p)} du
	$$
	збігається, то лему буде доведено, адже експонента – неперервна функція, і можна переходити до границі під експонентою.
	Зрозуміло, що
	$$
	-2 \int\limits_s^1 \frac{e^u - 1}{u(e^u - p)} du
	$$
	збігається для $\forall s \in (0;~1]$. Дійсно, оскільки $e^u - 1 < e^u - p$, підінтегральна функція $ \frac{1 - e^{-u}}{u}$ мажорується $\frac{1}{u}$, яка, в свою чергу, має скінченне значення інтегралу:
	$$
	\int\limits_s^1 \frac{1}{u} du = \ln 1 - \ln s = -\ln s,\quad s > 0
	$$
	Невизначеність виникає лише в точці 0. Знайдемо границю підінтегральної функції в точці 0:
	\begin{align*}
	\lim\limits_{s\rightarrow 0} \frac{e^u - 1}{u(e^u - p)} = \<\text{правило Лопіталя для невизначенності 0/0}\> = \\
	= \lim\limits_{s\rightarrow 0} \frac{e^u}{u e^u + (e^u-p)} = \frac{1}{1-p}
	\end{align*}
	Таким чином, підінтегральна функція обмежена в деякому $\varepsilon$-околі 0, тому інтеграл також збіжний, і лему доведено.
\end{proof}

\begin{lem}
	\label{eq:q_p_s_limited}
	Функція
	$$
	Q_p(s) = \int\limits_1^s \frac{1- p}{u(e^u - p)} du
	$$
	– обмежена на $[w; ~\infty], \; w>0$.
\end{lem}
\begin{proof}
	На проміжку $[1; ~\infty]$ підінтегральна функція мажорується функцією $e^{-u}$ (див. \eqref{eq:q_p_s_major}), а на проміжку $[w; ~1]$ – функцією $\frac{1}{u}$, адже $1- p < e^u - p, ~ u > 0$. Тому, аналогічно доведенню попередньої леми, інтеграл буде збіжний, і:
	\begin{align*}
	Q_p(s) \leq \int\limits_1^\infty e^{-u} du = \exp(-1) &,\quad s \geq 1 \\
	Q_p(s) \leq \int\limits_w^1 \frac{1}{u} du = - \ln w &, \quad s \in [w;~1]
	\end{align*}
	Таким чином, $Q_p(s) \leq \max\{-\ln w, \exp(-1)\}$.
\end{proof}

\begin{lem}
	Інтеграл
	$$
	\int\limits_0^\infty \frac{e^{2Q_p(u)}}{u^2} du
	$$
	– збіжний.
\end{lem}
\begin{proof}
	Спираючись на лему \eqref{eq:exp_q_p_s_asymptotics}, маємо, що підінтегральна функція прямує до деякої константи при $u \rightarrow 0$, оскільки є обернено пропорційною до функції з тої леми. Тому в деякому проколотому $\varepsilon$-околі точки 0 підінтегральна функція буде обмежена. На інтервалі $[\varepsilon; ~\infty]$ за лемою \eqref{eq:q_p_s_limited}, $Q_p(u)$ – обмежена, а тому і $\exp(2Q_p(u))$ також. Тому збіжність на інтервалі $[\varepsilon; ~\infty]$ виконується, якщо збігається інтеграл
	\[
	\int\limits_\varepsilon^\infty \frac{1}{u^2} du.
	\]
	А його збіжність – відомий факт.
\end{proof}

Таким чином, спираючись на доведені леми, маємо при $s \rightarrow 0$:
\begin{align*}
&M_p(s) \sim \frac{s^{-2}}{1-p} \cdot \exp\left(-2\int\limits_0^1 \frac{e^u  - 1}{u(e^u - p)} du\right) \int\limits_0^\infty \frac{e^{2Q_p(u)}}{u^2} du = \\
& = \frac{s^{-2}}{1-p} \cdot \exp\left(-2\int\limits_0^1 \frac{e^u  - 1}{u(e^u - p)} du\right) \int\limits_0^\infty \exp\left(2\int\limits_1^u \frac{1- p}{\tau(e^\tau - p)} d\tau - 2 \ln u\right) du = \\
& = \frac{s^{-2}}{1-p} \cdot \exp\left(-2\int\limits_0^1 \frac{e^u  - 1}{u(e^u - p)} du\right) \int\limits_0^\infty \exp\left(2\int\limits_1^u \frac{1- p}{\tau(e^\tau - p)} d\tau - 2  \int\limits_1^u  \frac{1}{\tau} d\tau \right) du = \\
& = \frac{s^{-2}}{1-p} \cdot \exp\left(-2\int\limits_0^1 \frac{e^u  - 1}{u(e^u - p)} du\right) \int\limits_0^\infty \exp\left(-2\int\limits_1^u \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau  \right) du = \\
& = \frac{s^{-2}}{1-p} \cdot \int\limits_0^\infty \exp\left( -2\int\limits_0^1 \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau -2\int\limits_1^u \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau  \right) du 
\end{align*}

Склавши інтеграли під експонентою, отримаємо:
\begin{equation}
M_p(s) \sim s^{-2} \cdot \underbrace{\frac{1}{1-p} \int\limits_0^\infty \exp\left( -2\int\limits_0^u \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau  \right) du}_{\text{збігається, не залежить від } s}, \quad s \rightarrow 0.
\end{equation}

Тепер, за теоремою Таубера маємо при $x \rightarrow \infty$:
\begin{equation}
\int\limits_0^x m_p(x) dx \sim \frac{1}{(1-p)\Gamma(2 + 1)} \int\limits_0^\infty \exp\left( -2\int\limits_0^u \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau  \right) du \cdot x^2.
\end{equation}

Або, продиференціювавши обидві частини,  отримаємо:
\begin{equation*}
m_p(x) \sim \frac{2}{(1- p) \Gamma(2 + 1)} \int\limits_0^\infty \exp\left( -2\int\limits_0^u \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau  \right) du \cdot x.
\end{equation*}
\begin{equation}
\label{eq:model_final}
m_p(x) \sim \frac{1}{1-p} \int\limits_0^\infty \exp\left( -2\int\limits_0^u \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau  \right) du \cdot x, \quad x \rightarrow \infty.
\end{equation}

Тут була можливість диференціювати обидві частини за правилом Лопіталя, адже має місце невизначеність $\infty / \infty$.

Таким чином було доведено, що $m_{p}(x) \sim C_{p} \cdot x$ при $x \rightarrow \infty$, де
\begin{equation}
C_{p} = \frac{1}{1-p} \int\limits_0^\infty \exp\left( -2\int\limits_0^u \frac{e^{\tau} - 1}{\tau(e^\tau - p)} d\tau  \right) du
\end{equation}
